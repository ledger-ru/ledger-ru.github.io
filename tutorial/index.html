<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="ru">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <meta name="google-site-verification" content="BRLJtg-Dz8fP9vutxOptMH3zMLYUI4XtK-mys0qoEIw" />
    <meta name="yandex-verification" content="b23adabdbe5325a3" />
    <title>Учебник Hledger - Личные финансы для гиков</title>
    <meta name="generator" content="Hugo 0.17" />

    
    <meta name="description" content="Ledger по-русски">
    
    <link rel="canonical" href="https://ledger-ru.github.io/tutorial/">
    
    <meta name="author" content="Igor Fokusov">
    

    <meta property="og:url" content="https://ledger-ru.github.io/tutorial/">
    <meta property="og:title" content="Личные финансы для гиков">
    <meta property="og:image" content="https://ledger-ru.github.io/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Личные финансы для гиков">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://ledger-ru.github.io/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://ledger-ru.github.io/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'icon';
        src: url('https://ledger-ru.github.io/fonts/icon.eot?52m981');
        src: url('https://ledger-ru.github.io/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('https://ledger-ru.github.io/fonts/icon.woff?52m981')
               format('woff'),
             url('https://ledger-ru.github.io/fonts/icon.ttf?52m981')
               format('truetype'),
             url('https://ledger-ru.github.io/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/application.css">
    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://ledger-ru.github.io/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue-grey palette-accent-blue-grey">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Учебник Hledger
      </div>
    </div>

       
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Главная" href="https://ledger-ru.github.io/">
	
	Главная
</a>


  
</li>



<li>
  
    



<a  title="Бухгалтерия для гика" href="https://ledger-ru.github.io/getting-started/">
	
	Бухгалтерия для гика
</a>


  
</li>



<li>
  
    



<a  title="Снимки экрана" href="https://ledger-ru.github.io/screenshots/">
	
	Снимки экрана
</a>


  
</li>



<li>
  
    



<a  title="Установка ledger" href="https://ledger-ru.github.io/install/">
	
	Установка ledger
</a>


  
</li>



<li>
  
    



<a class="current" title="Учебник hledger" href="https://ledger-ru.github.io/tutorial/">
	
	Учебник hledger
</a>


<ul id="scrollspy">
</ul>

  
</li>



<li>
  
    



<a  title="Шпаргалка ledger" href="https://ledger-ru.github.io/cheatsheet/">
	
	Шпаргалка ledger
</a>


  
</li>



<li>
  
    



<a  title="Список дел todo.txt" href="https://ledger-ru.github.io/todotxt/">
	
	Список дел todo.txt
</a>


  
</li>


        </ul>
        

        
        <hr>
        <span class="section">Контакты</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/ledger-ru" target="_blank" title="@ledger-ru on GitHub">
              @ledger-ru on GitHub
            </a>
          </li>
          
          
          
          <li>
            <a href="https://telegram.me/moneysaver" target="_blank" title="@moneysaver on Telegram">
              @moneysaver on Telegram
            </a>
          </li>
                   
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Учебник Hledger </h1>

			

<p>Ранее учет с ledger (на русском) был описан в статьях <a href="http://softdroid.net/planirovanie-finansov-ledger">Планирование финансов через командную стоку в ledger</a>, <a href="https://bronevichok.ru/blog/2014/09/27/personal-finances-with-ledger-1.html">Финансовый учёт с ledger</a> и <a href="http://s.arboreus.com/2009/05/personal-accounting-in-command-line.html">Ledger — бухучёт в командной строке</a>. Для общего развития рекомендую ознакомиться с ними.</p>

<h2 id="немного-теории">Немного теории</h2>

<p>Счетом мы называем любой вид Дохода/Расхода, а также любое &ldquo;место&rdquo;, откуда/куда приходят деньги. Кто-то называет их категориями, но суть от этого не меняется.</p>

<p>Обычно заводят такие счета как &ldquo;Продукты&rdquo;, &ldquo;Авто&rdquo;, &ldquo;Подарки&rdquo;, &ldquo;Зарплата&rdquo;, &ldquo;Наличные&rdquo;, &ldquo;Ипотека&rdquo; и т.п.</p>

<p>В системе двойной записи деньги переходят с одного счета на другой. И при этом отображаются в обоих строках транзакции с разными знаками.
К примеру, покупка книги за 500 рублей переводит деньги со счета &ldquo;Наличные&rdquo; на счет &ldquo;Книги&rdquo;. Получение зарплаты отражается как перевод денег со счета &ldquo;Зарплата&rdquo; на счет &ldquo;Наличные&rdquo; (ну или &ldquo;Банковская карта&rdquo;). Главное - помнить, что при перемещении денег в итоге должен быть обязательно ноль, иначе ничего не получится.</p>

<p>Итак, мы выяснили, что счета могут быть самые разные, но многие пользователи добавляют такие счета верхнего уровня:</p>

<p>• Расходы (Expenses) <br />
• Доходы (Income) <br />
• Активы (Assets) <br />
• Обязательства (Liabilities)</p>

<p>для того, чтобы в дальнейшем построить удобную структуру доходов/расходов. Иерархия счета таким образом может выглядеть так: &ldquo;Расходы&rdquo; -&gt; &ldquo;Авто&rdquo; -&gt; &ldquo;Бензин&rdquo;. И записываются такие счета в транзакциях через двоеточие: &ldquo;Расходы:Авто:Бензин&rdquo; (хотя вы можете использовать другой разделитель, об этом будет написано ниже).</p>

<h2 id="предупреждение">Предупреждение</h2>

<p>Я опишу здесь свой опыт реального использования утилиты hledger. Если у вас появятся вопросы, с радостью отвечу на них в комментариях или чате :)</p>

<p>Прежде всего, почему hledger, а не ledger-cli? На самом деле между ними нет большой разницы, используйте любую утилиту, благо формат журнала у них очень похожий. Мне нравятся функциональные языки программирования, а hledger написан на Haskell. При этом я пользуюсь MS Windows, а ledger-cli в этой ОС работает не очень хорошо. У hledger есть hledger-api для написания своих программ поверх hledger и я планирую заняться этим в ближайшее время, но и у ledger есть python api, который тоже очень удобен. В общем, решать вам, что использовать, я для себя пока выбрал hledger и он мне нравится :)</p>

<p>В этом учебнике мы создадим удобное дерево счетов, настроим программу на работу с несколькими валютами, покажем типовые сценарии использования различных финансовых инструментов и настроим удобный ввод транзакций. <br />
Также построим надежную и гибкую структуру файлов журнала с выгрузкой изменений в систему хранения версий BitBucket (в приватном бесплатном репозитории).</p>

<h2 id="создадим-файл-журнала">Создадим файл журнала</h2>

<p>Создайте пустой файл в блокноте и сохраните файл под любым именем, например &ldquo;ledger.txt&rdquo;.</p>

<p>В дальнейшем нужно будет запускать hledger так: </p>

<pre><code>hledger -f ledger.txt &lt;команда&gt;
</code></pre>

<p>Но для hledger можно назвать файл &ldquo;.hledger.journal&rdquo; и поместить его в директорию пользователя ( /home для *nix систем или &ldquo;C:\Users\&lt;Имя пользователя&gt;\&rdquo; в Windows ) и тогда при вызове hledger вам не нужно будет каждый раз указывать имя файла. Например, так:</p>

<pre><code>hledger &lt;команда&gt;
</code></pre>

<p>Предположим, вы так и сделали и у вас теперь есть файл журнала в домашней директории.</p>

<h2 id="ввод-транзакций">Ввод транзакций</h2>

<p>У hledger есть удобная команда интерактивного ввода <strong>add</strong>, <a href="https://ledger-ru.github.io/screenshots/#ввод-транзакций-с-hledger-add">здесь</a> вы можете ее увидеть в действии. Вы можете попробовать ввести с ее помощью транзакцию и затем посмотреть что записалось в файл журнала. <br />
Откройте журнал любимым редактором ( я рекомендую SublimeText3 с плагином подсветки/дополнения или Vim/Emacs ) и добавьте следующую операцию (или замените транзакцию, созданную при помощи команды add):</p>

<pre><code>2016/09/01 * Зарплата
	Кошелек:Наличные   10000 руб
	Доходы:Зарплата
</code></pre>

<p>Вкратце поясню что мы написали, но рекомендую все же ознакомиться с <a href="https://ledger-ru.github.io/cheatsheet/#формат-ledger">форматом записи ledger</a>. У нас описана операция получения зарплаты в размере 10000 руб от 1 сентября 2016 г. В ней мы зачисляем 10000 руб на счет &ldquo;Кошелек:Наличные&rdquo; со счета &ldquo;Доходы:Зарплата&rdquo;. <br />
Вы можете указать сумму с минусом в строке &ldquo;Доходы:Зарплата&rdquo;, но это не обязательно и важно только в транзакциях с тремя и более строками. Hledger автоматически понимает, что с другой стороны проводки нужная нам сумма.</p>

<p>При этом, в нашей транзакции указан флаг *, который говорит нам о том, что транзакция выверенная (флаг может быть ! и *, а можно его вообще не указывать). К примеру, вы вводите транзакции, а в конце недели сверяете с банковской выпиской, отмечая при этом сверенные транзакции флажком *. Знаком ! отмечают незаконченные транзакции (в статусе ожидания), но вам это, возможно, пригодится позже.</p>

<p><strong>Свой разделитель счетов.</strong> Если вам не нравится знак двоеточие между счетами, вы можете указать свой разделитель. Для этого в начале журнала добавьте псевдоним для двоеточия и программа его обработает как разделитель, к примеру, укажем точку:</p>

<pre><code># alias /РЕГУЛЯРНОЕ ВЫРАЖЕНИЕ/=ЗАМЕНА
alias /\./=:

2016/10/01 зарплата
    Кошелек.Расчетный счет  1000 руб
    Доход.Зарплата
</code></pre>

<p>Еще момент - необходимо указать минимум два пробела между счетом и суммой, иначе программа будет считать сумму частью названия счета и выдаст ошибку!</p>

<p>Теперь запустим отчет Баланс (команда balance или bal):</p>

<pre><code>hledger balance

          -10000 руб  Доходы:Зарплата
           10000 руб  Кошелек:Наличные
--------------------
                   0
</code></pre>

<p>Ноль под чертой очень важен и показывает, что у нас все транзакции записаны правильно с точки зрения двойной записи. А остаток в кошельке у нас 10 000 руб.</p>

<p><strong>Теперь вы видите насколько просто вести учет денег с ledger?</strong></p>

<p>Вы спросите, почему Доходы показаны с минусом? Если кратко, то в двойной записи деньги (как и любая другая ценность) должны откуда-то переместиться куда-то. В нашем примере они пришли со статьи дохода на статью расхода. Поэтому на счете поступления показан плюсовой остаток, а на другом счете - отрицательный. Иными словами, на счете дохода их стало меньше, чем в нашем кошельке :)</p>

<p>Введем еще одну операцию:</p>

<pre><code>2016/09/05 * Бензин
    Кошелек:Наличные
    Расходы:Авто     1000 руб
</code></pre>

<p>Вы можете вводить транзакции с помощью команды add, тогда вам не нужно запоминать форматирование, флаги и т.п. Однако, сам формат журнала ledger очень простой и вводить транзакции руками не сложно. Я чаще всего использую копирование предыдущих записей с правкой даты и суммы - для каждодневных трат это удобно. <br />
Для редких записей несложно либо найти их ранее в журнале, либо ввести &ldquo;с нуля&rdquo;, для этого и важно понимать формат.</p>

<h2 id="отчеты">Отчеты</h2>

<p>Чаще всего нужен ответ на вопрос &ldquo;Сколько я трачу в месяц на &hellip;?&rdquo; Увидеть это можно так:</p>

<pre><code>hledger -M register Расходы:Авто

2016/09                 Расходы:Авто                      1000 руб      1000 руб
</code></pre>

<p>Теперь купим немного продуктов:</p>

<pre><code>2016/09/21 * продукты
	Кошелек:Наличные
	Расходы:Продукты			700 руб
</code></pre>

<p>Запускаем баланс:</p>

<pre><code>hledger balance
          -10000 руб  Доходы:Зарплата
            8300 руб  Кошелек:Наличные
            1700 руб  Расходы
            1000 руб    Авто
             700 руб    Продукты
--------------------
                   0
</code></pre>

<p>Выводим список наших транзакций:</p>

<pre><code>hledger reg
2016/09/01 Зарплата             Кошелек:Наличные         10000 руб     10000 руб
                                Доходы:Зарплата         -10000 руб             0
2016/09/05 Бензин               Кошелек:Наличные         -1000 руб     -1000 руб
                                Расходы:Авто              1000 руб             0
2016/09/21 продукты             Кошелек:Наличные          -700 руб      -700 руб
                                Расходы:Продукты           700 руб             0
</code></pre>

<p>Ну и баланс еще раз:</p>

<pre><code># Сколько потратил на авто:
hledger bal Расходы:Авто
            1000 руб  Расходы:Авто
--------------------
            1000 руб

# Сколько у меня денег:
hledger bal ^Расходы ^Доходы
          -10000 руб  Доходы:Зарплата
            1700 руб  Расходы
            1000 руб    Авто
             700 руб    Продукты
--------------------
           -8300 руб
</code></pre>

<h2 id="дерево-статей">Дерево статей</h2>

<p>Один из самых важных вопросов в ведении личных доходов - удобное дерево статей (счетов). <br />
Кто-то пытается максимально подробно вести учет, вплоть до того, что делают статьи чрезмерно большой вложенности: &ldquo;Расходы - Продукты - Крупы - Гречка&rdquo;. Если вы ведете учет финансов больше года, то это может быть оправдано, но если вы только начали, то ведение настолько подробного учета прогонит все желание продолжать. <br />
Я предлагаю начать с малого и увеличивать количество статей в процессе. Итак, мы с вами уже описали счета &ldquo;Кошелек:Наличные&rdquo;, &ldquo;Доходы:Зарплата&rdquo;, &ldquo;Расходы:Авто&rdquo; и &ldquo;Расходы:Продукты&rdquo;. Отличное начало. <br />
Теперь представим основные кошельки / доходы / расходы / долги и на основе этого (пока мысленно) составим наше дерево статей. К слову, у меня примерно такое (это не файл примера):</p>

<pre><code>λ hledger accounts --tree   

Кошелек                                        
  Кредитка                   
  Наличные                   
Расходы                     
  Авто                       
    Бензин                   
    Налоги                    
    Ремонт                                       
  Здоровье                   
  Коммунальные               
  Налоги                     
  Одежда                     
  Продукты                   
  Прочие                     
  Связь                      
Кредиты
  Банк1
  Банк2
Доход                       
  Зарплата                  
  Прочий                     
</code></pre>

<p>Еще момент про дерево статей: когда мне нужно увидеть какой-то расход более подробно, я создаю для него отдельный счет. К примеру, все продукты я учитываю на счете &ldquo;Расходы:Продукты&rdquo;, но, к примеру, мне стало интересно, сколько я трачу на кофе ( и это не праздный интерес, кофе действительно стало уменьшаться очень быстро :) ). Для этого я создаю транзакции по покупке кофе так:</p>

<pre><code>2016/10/01 * кофе
    Кошелек:Наличные
    Расходы:Продукты:Кофе  200 руб
</code></pre>

<p>Так в вашем балансе будет видно расходы в целом на продукты, а также отдельной строкой затраты на кофе. Очень удобно!</p>

<p>Вы теперь умеете вводить транзакции (через команду <strong>add</strong> или вручную в текстовом редакторе) и пользуетесь при этом вашим деревом статей. Замечательно. Теперь давайте сделаем наш журнал более удобным.</p>

<h2 id="файл-журнала">Файл журнала</h2>

<p>Откроем снова наш файл .hledger.journal:</p>

<pre><code>; Это главный файл журнала hledger.
; Реальные данные содержатся в файлах в папке myledger
; Вложим актуальный журнал

include myledger/main.journal
</code></pre>

<p>Таким образом можно разбивать файлы транзакций по валютам, счетам, а также <a href="https://habrahabr.ru/post/308434/">по годам для удобства</a>. Что мы и сделаем:</p>

<p>Создайте папку <strong>myledger</strong> в домашней директории пользователя. Откройте ее.</p>

<p><strong>Предупреждение:</strong> Вы можете пропустить этот абзац, если не планируте хранить ваш журнал в системе версий. <br />
Зарегистрируйтесь на BitBucket и создайте новый приватный репозиторий. Нозовите его, к примеру, &ldquo;myledger&rdquo;.
Откройте терминал и перейдите в эту папку:</p>

<pre><code>cd myledger
git init
git remote add origin https://fokusov@bitbucket.org/fokusov/myledger.git
</code></pre>

<p><strong>примечание:</strong> название репозитория и имя пользователя замените на свое.</p>

<p>Создадим файл <strong>main.journal</strong> в этой папке и откроем его:</p>

<pre><code>alias Кредиты = Liabilities
alias Кошелек = Assets
alias Расходы = Expenses
alias Доходы = Income

D 1000.00 руб

include 2015.journal
include 2016.journal

end aliases

include prices.dat
</code></pre>

<p>Итак, в этом файле также нет транзакций, но указана метаинформация, очень важная для hledger. <br />
Первые строки, начинающиеся с alias - это наши псевдонимы для счетов, чтобы программа могла составлять правильно отчетные формы, а мы могли писать название корневых счетов по-русски. <br />
Далее идет строка <code>D 1000.00 руб</code>, описывающая валюту по-умолчанию и ее формат. Таким образом, не указывая явно валюту в каждой транзакции, мы будем знать, что она рублевая и пересчет между валютами будет корректен. <br />
Далее мы вкладываем журналы транзакций, разбитые по годам. Я веду учет три года и у меня вложены файлы журнала за последние три года. <br />
Сортировать по годам необязательно, но очень удобно, что записи разных лет хранятся в разных файлах, а не в одном большом.
Фразой <code>end aliases</code> мы завершаем применение псевдонимов к нашим файлам и ниже вкладываем файл с ценами prices.dat.</p>

<p>Создайте указанные файлы (2015.journal, 2016.journal, prices.dat) или закомментируйте строку с ненужным файлом. Комментарии начинаются со знака <code>;</code></p>

<p>Сохраним наши файлы в репозитории:</p>

<pre><code>git add *
git commit -m &quot;Initial commit&quot;
git push -u origin master
</code></pre>

<p>Теперь открываем файл нужного года (к примеру, 2016.journal) и вводим в него транзакции с помощью текстового редактора. Либо с помощью команды <strong>add</strong>, но с обязательным указание файла журнала, иначе она добавит наши транзакции в главный журнал:</p>

<pre><code>hledger add -f myledger\2016.journal
</code></pre>

<p>Сделаем командный файл, который будет выгружать наши изменения в удаленный репозиторий:</p>

<p>myledger\upd.cmd:</p>

<pre><code>git add -A
git commit -m &quot;upd&quot;
git push origin master
</code></pre>

<p>Добавим еще один служебный тег в текущий файл журнала (2016.journal):</p>

<p>Добавьте в начало файла указание на год:</p>

<pre><code>Y2016
</code></pre>

<p>Теперь мы можем вводить транзакции немного быстрее:</p>

<pre><code>10/01
    Кошелек:Наличные
    Расходы:Продукты    500
</code></pre>

<p>не указывая год и валюту (но если укажете год в транзакции, ничего страшного не произойдет). При этом программа знает, что это рублевая транзакция, совершенная в 2016 году.</p>

<h2 id="мультивалютность">Мультивалютность</h2>

<p>В ledger очень легко вести учет в разных валютах и пересчитывать их из одной в другую автоматически.</p>

<p>Для этого необходимо вести файл с ценами/курсами (этот файл также нужен для автоматического расчета стоимости ценных бумаг), который можно сделать для автоматической загрузки из сети. У нас он уже есть, это файл <strong>prices.dat</strong>. Откроем его:</p>

<pre><code>P 2016/10/28 10:00:00 USD 62.96 руб
P 2016/10/28 10:00:00 EUR 68.77 руб
</code></pre>

<p>Как мы видим, это официальные курсы валют центробанка на указанную дату, структурированные в формате ledger.</p>

<p>Если вы ведете транзакции в разной валюте, к примеру так:</p>

<pre><code>2016/09/01 Зарплата
  Кошелек:Наличные   10000 руб
  Доходы:Зарплата
  
2016/09/05 * Бензин
    Кошелек:Наличные
    Расходы:Авто     1000 руб

2016/09/21 * продукты
  Кошелек:Наличные
  Расходы:Продукты   700 руб

2016/09/10 Шабашка
  Кошелек:Наличные   500 USD
  Доходы:Прочие
</code></pre>

<p>то баланс будет не очень красивый:</p>

<pre><code>λ hledger bal
            -500 USD
          -10000 руб  Доходы
          -10000 руб    Зарплата
            -500 USD    Прочие
             500 USD
            8300 руб  Кошелек:Наличные
            1700 руб  Расходы
            1000 руб    Авто
             700 руб    Продукты
--------------------
                   0
</code></pre>

<pre><code># Попросим сконвертировать все данные в базовую валюту:
λ hledger bal -V
       -41480.00 руб  Доходы
       -10000.00 руб    Зарплата
       -31480.00 руб    Прочие
        39780.00 руб  Кошелек:Наличные
         1700.00 руб  Расходы
         1000.00 руб    Авто
          700.00 руб    Продукты
--------------------
                   0
</code></pre>

<p>Так лучше :)</p>

<p>Теперь введем валютную транзакцию, но чтобы она посчиталась корректно. Для этого есть три способа:</p>

<pre><code>; 1. указываем уже рассчитанную стоимость в рублях - к примеру, когда наш банк уже пересчитал ее по своему курсу и снял с карты
2016/10/28 покупка домена
    Кошелек:Карта
    Расходы:Прочие     8.17 USD @@ 514.38 руб


; 2. указываем курс валюты / цену товара за единицу
2016/10/28 покупка домена
    Кошелек:Карта
    Расходы:Прочие     8.17 USD @ 62.96 руб


; 3. позволим hledger рассчитать курс / цену
2016/10/28 покупка домена
    Кошелек:Карта      -514.38 руб
    Расходы:Прочие     8.17 USD

</code></pre>

<p>Выведите баланс в консоли и потом баланс с ключом -V.</p>

<h2 id="полезные-команды">Полезные команды</h2>

<p>У hledger есть немало команд, не говоря о плагинах. Но я рассмотрю те, которыми пользуюсь сам.</p>

<p>Команды:</p>

<pre><code>  print            выводит список транзакций на экран
  accounts         выводит названия счетов
  balance          выводит счета и баланс (bal)
  register         транзакции и сальдо каждой (reg)
  incomestatement  отчет о доходах и расходах (is)
  balancesheet     выводит баланс - активы/пассивы (bs)
  cashflow         выводит денежный поток (cf)
  activity         выводит диаграмму в ascii о движении денег за период
                   (по умолчанию: за день)
  stats            выводит статистику журнала
</code></pre>

<p>Выведем статистику моего журнала:</p>

<pre><code>λ hledger stats
Main file                : C:\Users\fokusov\.hledger.journal
Included files           : C:\Users\fokusov\myledger/main.journal
                           C:\Users\fokusov\myledger\2014.journal
                           C:\Users\fokusov\myledger\2015.journal
                           C:\Users\fokusov\myledger\2016.journal
                           C:\Users\fokusov\myledger\prices.dat
Transactions span        : 2014-04-01 to 2016-11-03 (947 days)
Last transaction         : 2016-11-02 (1 days ago)
Transactions             : 431 (0.5 per day)
Transactions last 30 days: 76 (2.5 per day)
Transactions last 7 days : 12 (1.7 per day)
Payees/descriptions      : 89
Accounts                 : 39 (depth 3)
Commodities              : 3 (EUR, USD, руб)
</code></pre>

<p>Интересное применение команды print:</p>

<pre><code># заархивируем 2015 год в отдельном файле
hledger print -b 2015 -e 2016 &gt; 2015.journal
</code></pre>

<p>Команда balancesheet</p>

<pre><code>$ hledger balancesheet
Balance Sheet

Assets:
                 $-1  assets
                  $1    Банк:Вклад
                 $-2    Наличные
--------------------
                 $-1

Liabilities:
                  $1  liabilities:Долги
--------------------
                  $1

Total:
--------------------
                   0
</code></pre>

<p>Команда cashflow</p>

<pre><code>$ hledger cashflow
Cashflow Statement

Cash flows:
                 $-1  assets
                  $1    Банк:Вклад
                 $-2    Наличные
--------------------
                 $-1

Total:
--------------------
                 $-1
</code></pre>

<p>Команда incomestatement</p>

<pre><code>$ hledger incomestatement
Income Statement

Revenues:
                 $-2  income
                 $-1    Подарки
                 $-1    Зарплата
--------------------
                 $-2

Expenses:
                  $2  expenses
                  $1    Продукты
                  $1    Прочее
--------------------
                  $2

Total:
--------------------
                   0
</code></pre>

<h2 id="еще-транзакции">Еще транзакции</h2>

<p>Я опишу для примера несколько видов транзакций, которыми пользуюсь сам - это учет долгов, ввод начальных остатков, ввод большого чека. Это справочная информация, возможно, она вам не пригодится. Однако, для общего развития очень полезна:</p>

<ul>
<li>Ввод начального остатка. К примеру, вы начали ведение журнала не с нуля, а имея начальные остатки. Здесь есть немало вариантов как это сделать, я покажу свой:</li>
</ul>

<pre><code>2016/09/01 начальный остаток
  Кошелек:Наличные   10000 руб
  Старт 

</code></pre>

<p>где &ldquo;Старт&rdquo; можно заменить на &ldquo;Капитал:Открытие счета&rdquo; или что-то подобное. Важно что на нужном счете появится нужная сумма, при этом взятая из другого источника (т.е. нам он не важен).</p>

<ul>
<li>Учет долгов. Здесь все просто - долг это такой же счет, но многие поначалу путаются, как правильно внести долги.</li>
</ul>

<pre><code>2016/09/01 Взял в долг у Ивана
  Кошелек:Наличные   10000 руб
  Долги:Иван

2016/09/11 Отдал долг Ивану
  Кошелек:Наличные
  Долги:Иван         10000 руб

</code></pre>

<ul>
<li>Большой чек. Вы купили много товаров, при этом хотите все внести одной транзакцией:</li>
</ul>

<pre><code>2016/10/01 * Леруа
  Кошелек:Наличные                 -47850 руб ; цифра введена для контроля, если ее не вводить, то она рассчитается автоматом
  Расходы:Ремонт квартиры:Обои     8250 руб
  Расходы:Ремонт квартиры:Краска   6300 руб
  Расходы:Ремонт квартиры:Ламинат  23000 руб
  Расходы:Ремонт квартиры:Светильник  10300 руб
</code></pre>

<h2 id="дальнейшая-работа">Дальнейшая работа</h2>

<p>Я продолжаю изучать возможности ledger и многое еще предстоит открыть. <br />
В ближайших планах: <br />
- настроить синхронизацию с мобильным приложением Monefy (или аналогом); <br />
- найти хороший веб-интерфейс для просмотра отчетов ledger; <br />
- настроить обмен данными с банками (выгрузка в csv); <br />
- настроить автоматический расчет налогов с дохода (6% для фрилансера на УСН) при вводе транзакций.</p>

<p>Возможно, вы тоже нашли интересные штуки при работе с ledger, поделитесь ими в комментариях :)</p>


		<h1>Обсуждение</h1>
<br>
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'ledger-ru';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

			<aside class="copyright" role="note">
				
				&copy; 2017 MIT license &ndash;
				
				Powered by
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				and 
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				
			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/ledger-ru.github.io\/';
      var repo_id  = 'ledger-ru\/ledger-ru.github.io';
    
    </script>

    <script src="https://ledger-ru.github.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;
            
            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }
        

        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-54274841-8', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

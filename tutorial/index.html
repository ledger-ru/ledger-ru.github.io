<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="ru">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <meta name="google-site-verification" content="BRLJtg-Dz8fP9vutxOptMH3zMLYUI4XtK-mys0qoEIw" />
    <title>Учебник Ledger - Личные финансы для гиков</title>
    <meta name="generator" content="Hugo 0.16" />

    
    <meta name="description" content="Ledger по-русски">
    
    <link rel="canonical" href="https://ledger-ru.github.io/tutorial/">
    
    <meta name="author" content="Igor Fokusov">
    

    <meta property="og:url" content="https://ledger-ru.github.io/tutorial/">
    <meta property="og:title" content="Личные финансы для гиков">
    <meta property="og:image" content="https://ledger-ru.github.io/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Личные финансы для гиков">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://ledger-ru.github.io/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://ledger-ru.github.io/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'icon';
        src: url('https://ledger-ru.github.io/fonts/icon.eot?52m981');
        src: url('https://ledger-ru.github.io/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('https://ledger-ru.github.io/fonts/icon.woff?52m981')
               format('woff'),
             url('https://ledger-ru.github.io/fonts/icon.ttf?52m981')
               format('truetype'),
             url('https://ledger-ru.github.io/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/application.css">
    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://ledger-ru.github.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://ledger-ru.github.io/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue-grey palette-accent-blue-grey">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Учебник Ledger
      </div>
    </div>

       
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Главная" href="https://ledger-ru.github.io/">
	
	Главная
</a>


  
</li>



<li>
  
    



<a  title="Бухгалтерия для гика" href="https://ledger-ru.github.io/getting-started/">
	
	Бухгалтерия для гика
</a>


  
</li>



<li>
  
    



<a  title="Снимки экрана" href="https://ledger-ru.github.io/screenshots/">
	
	Снимки экрана
</a>


  
</li>



<li>
  
    



<a  title="Установка ledger" href="https://ledger-ru.github.io/install/">
	
	Установка ledger
</a>


  
</li>



<li>
  
    



<a class="current" title="Учебник ledger" href="https://ledger-ru.github.io/tutorial/">
	
	Учебник ledger
</a>


<ul id="scrollspy">
</ul>

  
</li>



<li>
  
    



<a  title="Шпаргалка ledger" href="https://ledger-ru.github.io/cheatsheet/">
	
	Шпаргалка ledger
</a>


  
</li>



<li>
  
    



<a  title="Список дел todo.txt" href="https://ledger-ru.github.io/todotxt/">
	
	Список дел todo.txt
</a>


  
</li>


        </ul>
        

        
        <hr>
        <span class="section">Контакты</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/ledger-ru" target="_blank" title="@ledger-ru on GitHub">
              @ledger-ru on GitHub
            </a>
          </li>
          
          
          
          <li>
            <a href="https://telegram.me/ledger_ru" target="_blank" title="@ledger_ru on Telegram">
              @ledger_ru on Telegram
            </a>
          </li>
                   
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Учебник Ledger </h1>

			

<p>Основные моменты учета в ledger (на русском) описаны в статьях <a href="http://softdroid.net/planirovanie-finansov-ledger">Планирование финансов через командную стоку в ledger</a> и <a href="https://bronevichok.ru/blog/2014/09/27/personal-finances-with-ledger-1.html">Финансовый учёт с ledger</a>. Для общего развития рекомендую ознакомиться с ними.</p>

<h2 id="немного-теории">Немного теории</h2>

<p>Счетом мы называем любой вид Дохода/Расхода, а также любое &ldquo;место&rdquo;, откуда/куда приходят деньги. Кто-то называет их категориями, но суть от этого не меняется.</p>

<p>Обычно заводят такие счета как &ldquo;Продукты&rdquo;, &ldquo;Авто&rdquo;, &ldquo;Подарки&rdquo;, &ldquo;Зарплата&rdquo;, &ldquo;Наличные&rdquo;, &ldquo;Ипотека&rdquo; и т.п.</p>

<p>В системе двойной записи деньги переходят с одного счета на другой. И при этом отображаются в обоих строках транзакции с разными знаками.
К примеру, покупка книги за 500 рублей переводит деньги со счета &ldquo;Наличные&rdquo; на счет &ldquo;Книги&rdquo;. Получение зарплаты отражается как перевод денег со счета &ldquo;Зарплата&rdquo; на счет &ldquo;Наличные&rdquo; (ну или &ldquo;Банковская карта&rdquo;). Главное - помнить, что при перемещении денег в итоге должен быть обязательно ноль, иначе баланса не будет.</p>

<p>Итак, мы выяснили, что счета могут быть самые разные, но многие пользователи добавляют такие счета верхнего уровня:</p>

<p>• Расходы<br />
• Доходы<br />
• Активы<br />
• Обязательства</p>

<p>для того, чтобы в дальнейшем построить удобную структуру доходов/расходов. Счета таким образом могут выглядеть так: &ldquo;Расходы&rdquo; -&gt; &ldquo;Авто&rdquo; -&gt; &ldquo;Бензин&rdquo; и т.п. И записываются такие счета в транзакциях через двоеточие: &ldquo;Расходы:Авто:Бензин&rdquo;.</p>

<h2 id="создайте-файл-журнала">Создайте файл журнала</h2>

<p>В *nix-подобных системах вы можете создать пустой файл командой</p>

<pre><code>touch tutorial.dat
</code></pre>

<p>В Windows просто создайте пустой файл в блокноте и сохраните файл под нужным именем, например &ldquo;tutorial.dat&rdquo;. Но тут есть один нюанс: т.к. ledger собран под cygwin, он требует указания имени файла с необычным путем, например, так: &ldquo;/cygdrive/e/tutorial.dat&rdquo; (для диска E:\)</p>

<p>В дальнейшем запускать ledger так: </p>

<pre><code>ledger -f &quot;tutorial.dat&quot; &lt;команда&gt;
</code></pre>

<p>или так под Windows:</p>

<pre><code>ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot;
</code></pre>

<h2 id="файл-для-примера">Файл для примера</h2>

<p>Я создал файл, на котором мы будем тренироваться. Скачайте его и попробуйте поработать с ним для начала:
<a href="https://gist.github.com/fokusov/d226054c126566a2d4234683407c718d">tutorial.dat</a></p>

<p>Предположим, вы создали файл. Запустим основной отчет - баланс:</p>

<pre><code>ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; balance
</code></pre>

<p>Мы должны получить следующую картину:</p>

<p><img src="https://ledger-ru.github.io/tutorial1.png" alt="tutorial1" /></p>

<p>Здесь мы видим, что у нас есть 1000 руб наличными и долг в 1000 руб, введенные начальными остатками. Остатки введены специально для того, чтобы показать, как начать вести журнал не с чистого листа, а переносом остатков.</p>

<p>Попробуйте запустить отчет с фильтром:</p>

<pre><code>ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; balance Наличные
</code></pre>

<p>так мы увидим только транзакции с наличными. Фильтры будут рассматриваться еще не раз в дальнейшем.</p>

<h2 id="создание-транзакций">Создание транзакций</h2>

<p>Откройте файл любимым редактором (я рекомендую Vim/Emacs или SublimeText3 с плагином подсветки/дополнения) и добавьте следующую операцию:</p>

<pre><code>2016/09/01 * Зарплата
	Кошелек:Наличные		10000 руб
	Доходы:Зарплата
</code></pre>

<p>Вкратце поясню что мы написали, но рекомендую ознакомиться с <a href="https://ledger-ru.github.io/cheatsheet/#формат-ledger">форматом записи ledger</a>. У нас описана операция получения зарплаты в размере 10000 руб от 1 сентября. В ней мы зачисляем 10000 руб на счет &ldquo;Кошелек:Наличные&rdquo; со счета &ldquo;Доходы:Зарплата&rdquo;. Вы можете указать сумму с минусом в строке &ldquo;Доходы:Зарплата&rdquo;, но это не обязательно и важно только в транзакциях с тремя и более строками. Ledger автоматически понимает, что с другой стороны проводки нужная нам сумма. Запустите отчет баланса:</p>

<pre><code>E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; balance
           -1000 руб  Долги:Василий
          -10000 руб  Доходы:Зарплата
           11000 руб  Кошелек:Наличные
--------------------
                   0
</code></pre>

<p>Ноль под чертой очень важен и показывает, что у нас все транзакции записаны правильно с точки зрения двойной записи. А остаток в кошельке у нас 11 000 руб.</p>

<p><strong>Теперь вы видите насколько просто вести учет денег с ledger?</strong></p>

<p>Вы спросите, почему Доходы показаны с минусом? Если кратко, то в двойной записи деньги (как и любая другая ценность) должны откуда-то переместиться куда-то. В нашем примере они пришли со статьи дохода на статью расхода. Поэтому на счете поступления показан плюсовой остаток, а на другом счете - отрицательный. Иными словами, на счете дохода их стало меньше, чем в нашем кошельке :)</p>

<p>Введем еще одну операцию:</p>

<pre><code>2016/09/05 * Бензин
	Кошелек:Наличные
	Расходы:Авто		1000 руб
</code></pre>

<p>Чаще всего нужен ответ на вопрос &ldquo;Сколько я трачу в месяц на &hellip;?&rdquo; Увидеть это можно так:</p>

<pre><code>E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; -M register Расходы:Авто

16-Sep-01 - 16-Sep-30              Расходы:Авто                       1000 руб       1000 руб
</code></pre>

<p>Добавим операцию погашения долга:</p>

<pre><code>2016/09/13 * отдали долг
	Кошелек:Наличные
	Долги:Василий			1000 руб
</code></pre>

<p>и купим немного продуктов:</p>

<pre><code>2016/09/21 * продукты
	Кошелек:Наличные
	Расходы:Продукты			700 руб
</code></pre>

<p>Запускаем баланс:</p>

<pre><code>E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; balance
          -10000 руб  Доходы:Зарплата
            8300 руб  Кошелек:Наличные
            1700 руб  Расходы
            1000 руб    Авто
             700 руб    Продукты
--------------------
                   0
</code></pre>

<p>Выводим список транзакций:</p>

<pre><code> E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; reg
16-Aug-31 ввод нач. остатка      Кошелек:Наличные             1000 руб      1000 руб
                                 Старт                       -1000 руб             0
16-Aug-31 ввод остатка долга     Долги:Василий               -1000 руб     -1000 руб
                                 Старт                        1000 руб             0
16-Sep-01 Зарплата               Кошелек:Наличные            10000 руб     10000 руб
                                 Доходы:Зарплата            -10000 руб             0
16-Sep-05 Бензин                 Кошелек:Наличные            -1000 руб     -1000 руб
                                 Расходы:Авто                 1000 руб             0
16-Sep-13 отдали долг            Кошелек:Наличные            -1000 руб     -1000 руб
                                 Долги:Василий                1000 руб             0
16-Sep-21 продукты               Кошелек:Наличные             -700 руб      -700 руб
                                 Расходы:Продукты              700 руб             0
</code></pre>

<p>в последней колонке выводится актуальное сальдо каждой транзакции, дабы исключить ошибки.</p>

<p>То же самое помесячно:</p>

<pre><code>E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; reg -M
16-Aug-01 - 16-Aug-31            Долги:Василий                 -1000 руб     -1000 руб

                                 Кошелек:Наличные               1000 руб             0

16-Sep-01 - 16-Sep-30            Долги:Василий                  1000 руб      1000 руб

                                 Доходы:Зарплата              -10000 руб     -9000 руб

                                 Кошелек:Наличные               7300 руб     -1700 руб

                                 Расходы:Авто                   1000 руб      -700 руб

                                 Расходы:Продукты                700 руб             0
</code></pre>

<p>Транзакции определенного месяца:</p>

<pre><code>E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; reg -b 2016/09/01 -e 2016/09/30
16-Sep-01 Зарплата               Кошелек:Наличные              10000 руб     10000 руб

                                 Доходы:Зарплата              -10000 руб             0

16-Sep-05 Бензин                 Кошелек:Наличные              -1000 руб     -1000 руб

                                 Расходы:Авто                   1000 руб             0

16-Sep-13 отдали долг            Кошелек:Наличные              -1000 руб     -1000 руб

                                 Долги:Василий                  1000 руб             0

16-Sep-21 продукты               Кошелек:Наличные               -700 руб      -700 руб

                                 Расходы:Продукты                700 руб             0
</code></pre>

<p>Ну и баланс еще раз:</p>

<pre><code># Сколько потратил на авто:
E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; bal Расходы:Авто
            1000 руб  Расходы:Авто

# Сколько я заработал:
E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; bal ^Расходы ^Доходы --invert
           10000 руб  Доходы:Зарплата
           -1700 руб  Расходы
           -1000 руб    Авто
            -700 руб    Продукты
--------------------
            8300 руб         
</code></pre>

<h2 id="файл-журнала">Файл журнала</h2>

<p>Файл журнала может содержать не только транзакции, но еще и другую информацию.
Рассмотрим такой файл:</p>

<pre><code>; Это главный файл журнала ledger.
; Реальные данные содержатся в файле journal.txt, а конфигурация и
; прочее хранятся в файле meta.txt.

; Вложим файл конфига
include meta.txt

; Вложим актуальный журнал
include journal.txt
</code></pre>

<p>Таким образом можно разбивать файлы транзакций по валютам, счетам, а также <a href="https://habrahabr.ru/post/308434/">по годам для удобства</a>.</p>

<p>Теперь рассмотрим файл <code>meta.txt</code></p>

<p>Мы можем перечислить счета, которые возможны в наших транзакциях. Запустив ledger с ключом <code>--pedantic</code> мы получим ошибку если в журнале будет выбран счет, не указанный в файле конфигурации:</p>

<pre><code>account Активы:Расчетный счет
account Расходы:Обеды
account Расходы:Продукты
account Доход:Зарплата
</code></pre>

<p>Также можно задать валюты, которые должны быть в транзакциях:</p>

<pre><code>commodity RUR
commodity $
commodity €
commodity BTC
</code></pre>

<h2 id="мультивалютность">Мультивалютность</h2>

<p>В ledger очень легко вести учет в разных валютах и пересчитывать их из одной в другую.</p>

<p>Для этого необходимо вести файл с ценами/курсами (этот файл также нужен для автоматического расчета стоимости ценных бумаг), который можно сделать для автоматической загрузки из сети.</p>

<pre><code># Укажем файл цен в балансе и попросим сконвертировать все данные в нужную валюту:
E:\soft\ledger\ledger.exe -f &quot;/cygdrive/e/tutorial.dat&quot; --price-db prices.dat bal -X USD
             USD-157  Доходы:Зарплата
              USD130  Кошелек:Наличные
               USD27  Расходы
               USD16    Авто
               USD11    Продукты
--------------------
                   0
</code></pre>

<p>Рассмотрим детально файл <code>prices.dat</code> (вы можете назвать его как угодно):</p>

<pre><code>P 2016/08/02 10:00:00 USD 65,9553 руб.
P 2016/09/01 10:00:00 USD 65,2535 руб.
P 2016/09/23 10:00:00 USD 63,7942 руб.
</code></pre>

<p>Как мы видим, это официальные курсы валют центробанка, структурированные для ledger.</p>

<h2 id="загрузка-курсов-валют">Загрузка курсов валют</h2>

<p>Для себя я использую самописную утилиту <a href="https://github.com/fokusov/gopricedb">gopricedb</a>, которую запускаю по расписанию.
Она загружает курсы валют с сайта <a href="http://fixer.io/">fixer.io</a> в файл нужного формата, который я указываю в строке запуска ledger как было описано выше.</p>

<h2 id="бюджетирование">Бюджетирование</h2>

<p>&hellip;</p>


			<aside class="copyright" role="note">
				
				&copy; 2016 MIT license &ndash;
				
				Powered by
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				and 
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				
			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/ledger-ru.github.io\/';
      var repo_id  = 'ledger-ru\/ledger-ru.github.io';
    
    </script>

    <script src="https://ledger-ru.github.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;
            
            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }
        

        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-54274841-8', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
